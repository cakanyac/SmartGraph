<div style="padding: 20px;">
  <h2>Gestion des parcelles</h2>

  <div style="display: flex; gap: 20px;">
    <div style="flex: 0 0 250px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3 style="margin: 0;">S√©lectionner une parcelle</h3>
        <button (click)="openCreateForm()" 
                style="padding: 8px 12px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">
          + Ajouter
        </button>
      </div>
      <div style="display: flex; flex-direction: column; gap: 10px;">
        <button *ngFor="let parcelle of parcelles"
                (click)="selectParcelle(parcelle)"
                [style.background]="selectedParcelle?.id === parcelle.id ? '#007bff' : '#e9ecef'"
                [style.color]="selectedParcelle?.id === parcelle.id ? 'white' : 'black'"
                style="padding: 10px; border: none; border-radius: 5px; cursor: pointer; text-align: left;">
          {{ parcelle.nom }}
        </button>
      </div>
    </div>

    <div style="flex: 1;">
      <!-- Formulaire de cr√©ation/modification -->
      <div *ngIf="showForm" style="background: #f9f9f9; padding: 20px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 20px;">
        <h3>{{ isEditMode ? 'Modifier la parcelle' : 'Nouvelle parcelle' }}</h3>
        <div style="display: grid; gap: 15px;">
          <div>
            <label>Nom</label>
            <input [(ngModel)]="formData.nom" type="text" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
          </div>
          <div>
            <label>Superficie (ha)</label>
            <input [(ngModel)]="formData.superficie" type="number" step="0.1" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
          </div>
          <div>
            <label>Culture</label>
            <input [(ngModel)]="formData.culture" type="text" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
          </div>
          <div>
            <label>Type de sol</label>
            <input [(ngModel)]="formData.type_sol" type="text" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
          </div>
          <div>
            <label>Latitude</label>
            <input [(ngModel)]="formData.latitude" type="number" step="0.0001" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
          </div>
          <div>
            <label>Longitude</label>
            <input [(ngModel)]="formData.longitude" type="number" step="0.0001" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
          </div>
          <div style="display: flex; gap: 10px;">
            <button (click)="createParcelle()" style="flex: 1; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
              {{ isEditMode ? 'Modifier' : 'Cr√©er' }}
            </button>
            <button (click)="cancelForm()" style="flex: 1; padding: 10px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">
              Annuler
            </button>
          </div>
        </div>
      </div>

      <!-- D√©tails de la parcelle s√©lectionn√©e -->
      <div *ngIf="selectedParcelle && !showForm">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h3 style="margin: 0;">{{ selectedParcelle.nom }}</h3>
          <div style="display: flex; gap: 10px;">
            <button (click)="openEditForm()" style="padding: 8px 12px; background: #ffc107; color: white; border: none; border-radius: 4px; cursor: pointer;">
              ‚úèÔ∏è Modifier
            </button>
            <button (click)="deleteParcelle()" style="padding: 8px 12px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">
              üóëÔ∏è Supprimer
            </button>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 20px 0;">
          <div style="background: #f0f0f0; padding: 15px; border-radius: 5px;">
            <p style="margin: 0; color: #666; font-size: 12px;">SUPERFICIE</p>
            <h4 style="margin: 5px 0;">{{ selectedParcelle.superficie }} ha</h4>
          </div>
          <div style="background: #f0f0f0; padding: 15px; border-radius: 5px;">
            <p style="margin: 0; color: #666; font-size: 12px;">CULTURE</p>
            <h4 style="margin: 5px 0;">{{ selectedParcelle.culture }}</h4>
          </div>
          <div style="background: #f0f0f0; padding: 15px; border-radius: 5px;">
            <p style="margin: 0; color: #666; font-size: 12px;">TYPE DE SOL</p>
            <h4 style="margin: 5px 0;">{{ selectedParcelle.type_sol }}</h4>
          </div>
          <div style="background: #d1ecf1; padding: 15px; border-radius: 5px;">
            <p style="margin: 0; color: #0c5460; font-size: 12px;">COORDONN√âES</p>
            <h4 style="margin: 5px 0; color: #0c5460;">{{ selectedParcelle.latitude }}, {{ selectedParcelle.longitude }}</h4>
          </div>
        </div>

        <h4 style="margin-top: 30px;">Capteurs</h4>
        <div *ngIf="capteurs.length === 0" style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; color: #666; margin-top: 15px;">
          Aucun capteur trouv√© pour cette parcelle
        </div>
        <table *ngIf="capteurs.length > 0" style="width: 100%; border-collapse: collapse; margin-top: 15px;">
          <thead>
            <tr style="background: #f0f0f0; border-bottom: 2px solid #ddd;">
              <th style="padding: 10px; text-align: left;">ID</th>
              <th style="padding: 10px; text-align: left;">Type</th>
              <th style="padding: 10px; text-align: left;">Statut</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let capteur of capteurs" style="border-bottom: 1px solid #ddd;">
              <td style="padding: 10px;">{{ capteur.id }}</td>
              <td style="padding: 10px;">{{ capteur.type }}</td>
              <td style="padding: 10px;">
                <span *ngIf="capteur.statut === 'actif'" style="background: #2d6a4f; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                  ‚úì Actif
                </span>
                <span *ngIf="capteur.statut !== 'actif'" style="background: #d4a574; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                  ‚äò Inactif
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
